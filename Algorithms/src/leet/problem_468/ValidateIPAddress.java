package leet.problem_468;

import java.util.regex.Matcher;
import java.util.regex.Pattern;

public class ValidateIPAddress {

	public static void main(String[] args) {
		String ip = "255.234.2.2";
		//String ip = "172.16.254.1";
		//String ip = "01.01.01.01";
		//String ip = "1111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111.1111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111.1111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111.1111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111.";
		// String ip = "2001:0db8:85a3:0:0:8A2E:0370:734";

		System.out.println(new ValidateIPAddress().validIPAddress(ip));
	}

	private static Pattern ipv4Pattern = Pattern.compile("(\\d+).(\\d+).(\\d+).(\\d+)");
	private static Pattern ipv6Pattern = Pattern.compile(
			"([A-Za-z0-9]+):([A-Za-z0-9]+):([A-Za-z0-9]+):([A-Za-z0-9]+):([A-Za-z0-9]+):([A-Za-z0-9]+):([A-Za-z0-9]+):([A-Za-z0-9]+)");

	public String validIPAddress(String ip) {
		String ipv4 = "IPv4";
		String ipv6 = "IPv6";
		String neither = "Neither";
		if (ip == null || ip.length() == 0)
			return neither;

		if (ip.contains(".")) {
			
			Matcher m = ipv4Pattern.matcher(ip);
			
			if (!m.matches() || m.groupCount() > 4)
				return neither;

			for (int i = 1; i <= m.groupCount(); i++) {
				try {
					String s = m.group(i);
					if (s.startsWith("0") || Integer.parseInt(s) > 255)
						return neither;
				} catch (NumberFormatException nfe) {
					return neither;
				}
			}
			return ipv4;
		} else if (ip.contains(":")) {
			Matcher m = ipv6Pattern.matcher(ip);
			if (!m.matches() || m.groupCount() > 8)
				return neither;
			for (int i = 1; i <= m.groupCount(); i++) {
				String s = m.group(i);
				if (s.length() > 4)
					return neither;
				try {
					Long.parseLong(s, 16);
				} catch (NumberFormatException ex) {
					return neither;
				}
			}
			return ipv6;
		}
		return neither;
	}
}
